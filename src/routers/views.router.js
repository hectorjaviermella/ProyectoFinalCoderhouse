import { Router } from "express";
import { checkLogged, checkLogin } from "../middlewares/auth.js";
import  productsService  from "../services/products.service.js";
import  cartsService  from "../services/carts.service.js";
import  {sendEmail} from "../controllers/mail.controller.js";
import { mockingproducts} from "../controllers/products.controller.js";
import { loggerTest} from "../controllers/logger.controller.js";

import { getUsersDto} from "../controllers/users.controller.js";

import { checkPermisosAdministrador ,checkVistaAdministrador,checkDocCargados} from "../middlewares/auth.js";



import {login,register,current, restore,restablecer,recuperacion,reset,inicio,getProducts, getProductsById,getCartsById,ticket, newproduct, getUsers,getUsersById,switchRol,getTicketByUser,creditCard,payment,processpayment} from "../controllers/views.controller.js";



export const viewsRouter = Router();

//////////////////////////////////////////////////////////////////////////////////////////////

viewsRouter.get("/login", checkLogged,login);
//////////////////////////////////////////////////////////////////////////////////////////////
viewsRouter.get("/register", checkLogged,register);

//////////////////////////////////////////////////////////////////////////////////////////////
viewsRouter.get("/restore/", restore);
//////////////////////////////////////////////////////////////////////////////////////////////

viewsRouter.get("/restablecer/:cId", restablecer);

//////////////////////////////////////////////////////////////////////////////////////////////////////
viewsRouter.post("/recuperacion", recuperacion);

//////////////////////////////////////////////////////////////////////////////////////////////////////
viewsRouter.post("/reset", reset);

//////////////////////////////////////////////////////////////////////////////////////////////
viewsRouter.get("/", checkLogged,inicio);



//////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//add new producto
viewsRouter.get("/newproduct", checkPermisosAdministrador ,newproduct);

/////////////////////////////////////////////////////////////////////////////////////
//muestra un carrito
viewsRouter.get("/cart/:cId", getCartsById);

///////////////////////////////////////////////////////////////
//envia un email
viewsRouter.get("/mail",sendEmail);

///////////////////////////////////////////////////////////////
//crea una lista de productos con facker para pruebas
viewsRouter.get("/mockingproducts", mockingproducts);


///////////////////////////////////////////////////////////////
//envia un testeo de errores
viewsRouter.get("/loggerTest",loggerTest);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//muestra todo los usuarios 
viewsRouter.get("/users", checkVistaAdministrador,getUsers);
///////////////////////////////////////////////////////////////////////////////////
//muestra un usuario
viewsRouter.get("/user/:uId", getUsersById);


/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//muestra todo los productos 
viewsRouter.get("/products", getProducts);

///////////////////////////////////////////////////////////////////////////////////
//muestra un producto
viewsRouter.get("/product/:pId", getProductsById);
///////////////////////////////////////////////////////////////////////////////////
//cambia el rol del usuario
viewsRouter.get("/premium/:uid",checkDocCargados,switchRol);

///////////////////////////////////////////////////////////////
//viewsRouter.get("/cart/:cid/purchase",ticket)
viewsRouter.get("/ticket/:cId",ticket)

///////////////////////////////////////////////////////////////////////////////////
//muestra un usuario
viewsRouter.get("/ticketsUser/:uId", getTicketByUser);

///////////////////////////////////////////////////////////////////////////////////
//intento de pago
viewsRouter.get("/payment-intents",payment);
/////////////////////////////////////////////////////////////////////////
//muestra un usuario
viewsRouter.get("/creditCard", creditCard);

//cierra la compra
viewsRouter.post("/processpayment", processpayment);
/////////////////////////////////////////////////////////////////////////


export default viewsRouter;